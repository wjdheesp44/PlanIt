<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gt.planit.domain.spot.model.mapper.RegionMapper">
    <resultMap id="RegionResMap" type="com.gt.planit.domain.spot.model.dto.RegionRes">
        <!-- 시/도 -->
        <id     property="id"       column="sido_id"/>
        <result property="sidoName" column="sido_name"/>

        <!-- 구/군 리스트 -->
        <collection property="guguns"
                    ofType="com.gt.planit.domain.spot.model.dto.RegionRes$GugunRes">
            <id     property="id"        column="gugun_id"/>
            <result property="gugunName" column="gugun_name"/>
        </collection>
    </resultMap>

    <!-- 시도 + 그 하위 구군 전체 조회 -->
    <select id="selectRegions" resultMap="RegionResMap">
        SELECT
        s.id          AS sido_id,
        s.sido_name   AS sido_name,
        g.id          AS gugun_id,
        g.gugun_name  AS gugun_name
        FROM sidos s
        LEFT JOIN guguns g
        ON g.sido_id = s.id
        ORDER BY
        s.sido_code ASC,
        g.gugun_code ASC
    </select>

</mapper>